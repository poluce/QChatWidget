# ChatWidget Demo 面板设计（test/we_chat_style/main.cpp）

## 目标
在 `test/we_chat_style/main.cpp` 内增加一个手动控制面板，用按钮驱动方式演示 `src/chatwidget` 的全部主要功能，避免改动组件实现。

## 方案概述
- 窗口采用左右布局：左侧为 `ChatWidget`，右侧为 `QScrollArea` 包裹的控制面板。
- 控制面板以按钮分组形式覆盖全部 API（消息、流式、参与者、历史、空态、输入行为）。
- 通过 `findChild` 获取输入区子控件（基于对象名）以模拟命令菜单、语音按钮和附件菜单。
- 顶部状态栏 `QLabel` 显示最近动作与结果。

## 功能分组与按钮清单
1) **基础消息**：添加我的消息、添加他人消息、清空消息、移除最后一条、消息计数。
2) **流式与发送状态**：开始模拟流式、追加流式片段、停止发送/流式、置为发送中。
3) **参与者管理**：设置当前用户、upsert 参与者、更新参与者头像、移除/清空参与者、检查参与者。
4) **历史消息**：载入历史（重置）、追加历史（去重）、前插历史（去重）。
5) **空状态**：显示/隐藏空状态、查询空状态。
6) **输入/交互展示**：触发命令菜单、切换翻译模式、模拟语音按钮、打开附件菜单、头像点击反馈（用户在聊天区点击）。

## 数据流与实现细节
- 控制面板按钮的 clicked 信号 → ChatWidget API 调用或输入控件模拟 → UI 更新。
- 历史消息构造固定 `messageId` 与 `timestamp`，用于排序与去重展示。
- 参与者更新使用相同 `senderId` 触发头像/昵称刷新。
- 流式演示：`startSimulatedStreaming` 自动输出；手动 `streamOutput` 先注入空 AI 消息并 `setSendingState(true)`。
- `findChild` 失败时仅更新状态栏提示，不抛异常。

## 测试方式
- 运行 `test/we_chat_style` 示例，逐项点击按钮确认 UI 行为。
- 验证：命令菜单弹出、语音按钮切换、附件菜单弹出、头像点击信号、历史去重与排序。
